{"version":3,"sources":["wc-square-admin-products.js"],"names":["jQuery","document","ready","$","typenow","window","pagenow","wc_square_admin_products","is_product_sync_enabled","on","e","$row","target","closest","postID","find","val","data","action","security","get_quick_edit_product_details_nonce","product_id","post","ajax_url","response","$editRow","$squareSynced","$errors","success","prop","show","$sku","$stockStatus","$stockQty","$manageStockLabel","$manageStockInput","$manageStockDesc","settings_url","i18n","synced_with_square","edit_url","is_variable","is_synced_with_square","trigger","hide","off","add","css","opacity","remove","is","append","is_woocommerce_sor","syncCheckboxID","synced_with_square_taxonomy","isVariable","variable_product_types","includes","hasSKU","trim","hasVariableSKUs","skus","length","valid","filter","sku","hasUniqueSKUs","skuValues","map","every","indexOf","lastIndexOf","hasMultipleAttributes","$variation_attributes","showError","error","hideError","enable","handleSKU","makeArray","triggerHandler","handleAttributes","triggerUpdate","$stockFields","$stockInput","$manageField","$manageInput","$manageDesc","manageDescOriginal","text","manageStockOriginal","is_inventory_sync_enabled","variableProduct","useSquare","html","after","fetch_stock_with_square","preventDefault","$spinner","fetch_product_stock_with_square_nonce","quantity","is_square_sor","managed_by_square","each","index","variationID","attr","$variationManageInput","$variationManageField","parent","$variationStockInput","$variationStockField","fetchVariationStockActionID","next"],"mappings":"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","sourcesContent":["/* global wc_square_admin_products */\n\n/**\n * WooCommerce Square admin general scripts for the settings page and update tab.\n *\n * @since 2.0.0\n */\njQuery( document ).ready( ( $ ) => {\n\tconst typenow = window.typenow || '';\n\tconst pagenow = window.pagenow || '';\n\n\t// bail if not on product admin pages.\n\tif ( 'product' !== typenow ) {\n\t\treturn;\n\t}\n\n\t// bail if product sync is disabled.\n\tif ( ! wc_square_admin_products.is_product_sync_enabled ) {\n\t\treturn;\n\t}\n\n\t// products quick edit screen.\n\tif ( 'edit-product' === pagenow ) {\n\t\t// when clicking the quick edit button fetch the default Synced with Square checkbox\n\t\t$( '#the-list' ).on( 'click', '.editinline', ( e ) => {\n\t\t\tconst $row = $( e.target ).closest( 'tr' );\n\t\t\tconst postID = $row.find( 'th.check-column input' ).val();\n\t\t\tconst data = {\n\t\t\t\taction: 'wc_square_get_quick_edit_product_details',\n\t\t\t\tsecurity: wc_square_admin_products.get_quick_edit_product_details_nonce,\n\t\t\t\tproduct_id: $row.find( 'th.check-column input' ).val(),\n\t\t\t};\n\n\t\t\t$.post( wc_square_admin_products.ajax_url, data, ( response ) => {\n\t\t\t\tconst $editRow = $( 'tr#edit-' + postID );\n\t\t\t\tconst $squareSynced = $editRow.find( 'select.square-synced' );\n\t\t\t\tconst $errors = $editRow.find( '.wc-square-sync-with-square-errors' );\n\n\t\t\t\tif ( ! response.success && response.data ) {\n\t\t\t\t\t// if the product has multiple attributes we show an inline error message and bail.\n\t\t\t\t\tif ( 'multiple_attributes' === response.data ) {\n\t\t\t\t\t\t$squareSynced.prop( 'checked', false );\n\t\t\t\t\t\t$squareSynced.prop( 'disabled', true );\n\t\t\t\t\t\t$errors.find( '.multiple_attributes' ).show();\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t// if the product has variations without an SKU we show an inline error message and bail.\n\t\t\t\t\t} else if ( 'missing_variation_sku' === response.data ) {\n\t\t\t\t\t\t$squareSynced.prop( 'checked', false );\n\t\t\t\t\t\t$squareSynced.prop( 'disabled', true );\n\t\t\t\t\t\t$errors.find( '.missing_variation_sku' ).show();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst $sku = $editRow.find( 'input[name=_sku]' );\n\t\t\t\tconst $stockStatus = $editRow.find( 'select[name=_stock_status]' );\n\t\t\t\tconst $stockQty = $editRow.find( 'input[name=_stock]' );\n\t\t\t\tconst $manageStockLabel = $editRow.find( '.manage_stock_field .manage_stock' );\n\t\t\t\tconst $manageStockInput = $editRow.find( 'input[name=_manage_stock]' );\n\t\t\t\tconst $manageStockDesc = '<span class=\"description\"><a href=\"' + wc_square_admin_products.settings_url + '\">' + wc_square_admin_products.i18n.synced_with_square + '</a></span>';\n\t\t\t\tconst edit_url = response.data.edit_url;\n\t\t\t\tconst i18n = response.data.i18n;\n\t\t\t\tconst is_variable = response.data.is_variable;\n\n\t\t\t\t$squareSynced.val( response.data.is_synced_with_square );\n\n\t\t\t\t// if the SKU changes, enabled or disable Synced with Square checkbox accordingly\n\t\t\t\t$sku.on( 'change keyup keypress', ( e ) => {\n\t\t\t\t\tif ( '' === $( e.target ).val() && ! is_variable ) {\n\t\t\t\t\t\t$squareSynced.val( 'no' ).trigger( 'change' );\n\t\t\t\t\t\t$squareSynced.prop( 'disabled', true );\n\t\t\t\t\t\t$errors.find( '.missing_sku' ).show();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$squareSynced.prop( 'disabled', false );\n\t\t\t\t\t\t$squareSynced.trigger( 'change' );\n\t\t\t\t\t\treturn $errors.find( '.missing_sku' ).hide();\n\t\t\t\t\t}\n\t\t\t\t} ).trigger( 'change' );\n\n\t\t\t\t// if Synced with Square is enabled, we might as well disable stock management (without verbose explanations as in the product page).\n\t\t\t\t$squareSynced.on( 'change', ( e ) => {\n\t\t\t\t\tif ( 'no' === $( e.target ).val() ) {\n\t\t\t\t\t\t$manageStockInput.off();\n\t\t\t\t\t\t$manageStockInput.add( $stockQty ).css( {\n\t\t\t\t\t\t\topacity: 1,\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t$manageStockLabel.find( '.description' ).remove();\n\n\t\t\t\t\t\t// Stock input manipulation will differ depending on whether product is variable or simple.\n\t\t\t\t\t\tif ( is_variable ) {\n\t\t\t\t\t\t\tif ( $manageStockInput.is( ':checked' ) ) {\n\t\t\t\t\t\t\t\t$( '.stock_qty_field' ).show();\n\t\t\t\t\t\t\t\t$( '.backorder_field' ).show();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$( '.stock_status_field' ).show();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$stockQty.prop( 'readonly', false );\n\t\t\t\t\t\t\t$stockStatus.prop( 'readonly', false );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$manageStockInput.prop( 'checked', true );\n\t\t\t\t\t\t$manageStockInput.on( 'click', () => {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t$manageStockInput.add( $stockQty ).css( {\n\t\t\t\t\t\t\topacity: '0.5',\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t$manageStockLabel.append( $manageStockDesc );\n\n\t\t\t\t\t\tif ( wc_square_admin_products.is_woocommerce_sor && edit_url && i18n ) {\n\t\t\t\t\t\t\t$manageStockLabel.append( '<p class=\"description\"><a href=\"' + edit_url + '\">' + i18n + '</a></p>' );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( is_variable ) {\n\t\t\t\t\t\t\t$( '.stock_status_field' ).hide();\n\t\t\t\t\t\t\t$( '.stock_qty_field' ).hide();\n\t\t\t\t\t\t\t$( '.backorder_field' ).hide();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$stockQty.prop( 'readonly', true );\n\t\t\t\t\t\t\t$stockStatus.prop( 'readonly', true );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} ).trigger( 'change' );\n\t\t\t} );\n\t\t} );\n\t}\n\n\t// individual product edit screen.\n\tif ( 'product' === pagenow ) {\n\t\tconst syncCheckboxID = '#_' + wc_square_admin_products.synced_with_square_taxonomy;\n\n\t\t/**\n\t\t * Checks whether the product is variable.\n\t\t *\n\t\t * @since 2.0.0\n\t\t */\n\t\tconst isVariable = () => {\n\t\t\treturn wc_square_admin_products.variable_product_types.includes( $( '#product-type' ).val() );\n\t\t};\n\n\t\t/**\n\t\t * Checks whether the product has a SKU.\n\t\t *\n\t\t * @since 2.0.0\n\t\t */\n\t\tconst hasSKU = () => {\n\t\t\treturn '' !== $( '#_sku' ).val().trim();\n\t\t};\n\n\t\t/**\n\t\t * Checks whether the product variations all have SKUs.\n\t\t *\n\t\t * @since 2.2.3\n\t\t *\n\t\t * @param {Array} skus\n\t\t */\n\t\tconst hasVariableSKUs = ( skus ) => {\n\t\t\tif ( ! skus.length ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst valid = skus.filter( ( sku ) => '' !== $( sku ).val().trim() );\n\n\t\t\treturn valid.length === skus.length;\n\t\t};\n\n\t\t/**\n\t\t * Checks whether the given skus are unique.\n\t\t *\n\t\t * @since 2.2.3\n\t\t *\n\t\t * @param {Array} skus\n\t\t */\n\t\tconst hasUniqueSKUs = ( skus ) => {\n\t\t\tconst skuValues = skus.map( ( sku ) => $( sku ).val() );\n\n\t\t\treturn skuValues.every( ( sku ) => skuValues.indexOf( sku ) === skuValues.lastIndexOf( sku ) );\n\t\t};\n\n\t\t/**\n\t\t * Checks whether the product has more than one variation attribute.\n\t\t *\n\t\t * @since 2.0.0\n\t\t */\n\t\tconst hasMultipleAttributes = () => {\n\t\t\tconst $variation_attributes = $( '.woocommerce_attribute_data input[name^=\"attribute_variation\"]:checked' );\n\n\t\t\treturn isVariable() && $variation_attributes && $variation_attributes.length > 1;\n\t\t};\n\n\t\t/**\n\t\t * Displays the given error and disables the sync checkbox.\n\t\t * Accepted errors are 'missing_sku', 'missing_variation_sku', and 'multiple_attributes'.\n\t\t *\n\t\t * @since 2.2.3\n\t\t *\n\t\t * @param {string} error\n\t\t */\n\t\tconst showError = ( error ) => {\n\t\t\t$( '.wc-square-sync-with-square-error.' + error ).show();\n\t\t\t$( syncCheckboxID ).prop( 'disabled', true );\n\t\t\t$( syncCheckboxID ).prop( 'checked', false );\n\t\t};\n\n\t\t/**\n\t\t * Hides the given error and maybe enables the sync checkbox.\n\t\t * Accepted errors are 'missing_sku', 'missing_variation_sku', and 'multiple_attributes'.\n\t\t *\n\t\t * @since 2.2.3\n\t\t *\n\t\t * @param {string} error\n\t\t * @param {boolean} enable Whether to enable the sync checkbox.\n\t\t */\n\t\tconst hideError = ( error, enable = true ) => {\n\t\t\t$( '.wc-square-sync-with-square-error.' + error ).hide();\n\n\t\t\tif ( enable ) {\n\t\t\t\t$( syncCheckboxID ).prop( 'disabled', false );\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Handle SKU.\n\t\t *\n\t\t * Disables the Sync with Square checkbox and toggles an inline notice when no SKU is set on a product.\n\t\t *\n\t\t * @since 2.0.\n\t\t *\n\t\t * @param {string} syncCheckboxID\n\t\t */\n\t\tconst handleSKU = ( syncCheckboxID ) => {\n\t\t\tif ( isVariable() ) {\n\t\t\t\t$( '#_sku' ).off( 'change keypress keyup' );\n\t\t\t\thideError( 'missing_sku', ! hasMultipleAttributes() );\n\n\t\t\t\tconst skus = $( 'input[id^=\"variable_sku\"]' );\n\t\t\t\tskus.on( 'change keypress keyup', () => {\n\t\t\t\t\tif ( ! hasVariableSKUs( $.makeArray( skus ) ) || ! hasUniqueSKUs( $.makeArray( skus ) ) ) {\n\t\t\t\t\t\tshowError( 'missing_variation_sku' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\thideError( 'missing_variation_sku', ! hasMultipleAttributes() );\n\t\t\t\t\t}\n\t\t\t\t\t$( syncCheckboxID ).triggerHandler( 'change' );\n\t\t\t\t} ).triggerHandler( 'change' );\n\t\t\t} else {\n\t\t\t\t$( 'input[id^=\"variable_sku\"]' ).off( 'change keypress keyup' );\n\t\t\t\thideError( 'missing_variation_sku', ! hasMultipleAttributes() );\n\n\t\t\t\t$( '#_sku' ).on( 'change keypress keyup', ( e ) => {\n\t\t\t\t\tif ( '' === $( e.target ).val().trim() ) {\n\t\t\t\t\t\tshowError( 'missing_sku' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\thideError( 'missing_sku', ! hasMultipleAttributes() );\n\t\t\t\t\t}\n\t\t\t\t\t$( syncCheckboxID ).trigger( 'change' );\n\t\t\t\t} ).trigger( 'change' );\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Disables the Sync with Square checkbox and toggles an inline notice when more than one attribute is set on the product.\n\t\t *\n\t\t * @since 2.0.0\n\t\t *\n\t\t * @param {string} syncCheckboxID\n\t\t */\n\t\tconst handleAttributes = ( syncCheckboxID ) => {\n\t\t\t$( '#variable_product_options' ).on( 'reload', () => {\n\t\t\t\tif ( hasMultipleAttributes() ) {\n\t\t\t\t\tshowError( 'multiple_attributes' );\n\t\t\t\t} else {\n\t\t\t\t\thideError( 'multiple_attributes', isVariable() ? hasVariableSKUs : hasSKU() );\n\t\t\t\t}\n\n\t\t\t\t$( syncCheckboxID ).trigger( 'change' );\n\t\t\t} ).trigger( 'reload' );\n\t\t};\n\n\t\t/**\n\t\t * Triggers an update to the sync checkbox, checking for relevant errors.\n\t\t *\n\t\t * @since 2.2.3\n\t\t */\n\t\tconst triggerUpdate = () => {\n\t\t\thandleSKU( syncCheckboxID );\n\t\t\t$( syncCheckboxID ).trigger( 'change' );\n\n\t\t\t// handleSKU misses cases where product is variable with no variations.\n\t\t\tif ( isVariable() && ! $( 'input[id^=\"variable_sku\"]' ).length ) {\n\t\t\t\tshowError( 'missing_variation_sku' );\n\t\t\t}\n\t\t};\n\n\t\t// fire once on page load\n\t\thandleAttributes( syncCheckboxID );\n\n\t\t/**\n\t\t * Handle stock management.\n\t\t *\n\t\t * If product is managed by Square, handle stock fields according to chosen SoR.\n\t\t */\n\t\tconst $stockFields = $( '.stock_fields' );\n\t\tconst $stockInput = $stockFields.find( '#_stock' );\n\t\tconst $stockStatus = $( '.stock_status_field' );\n\t\tconst $manageField = $( '._manage_stock_field' );\n\t\tconst $manageInput = $manageField.find( '#_manage_stock' );\n\t\tconst $manageDesc = $manageField.find( '.description' );\n\t\t// keep note of the original manage stock checkbox description, if we need to restore it later\n\t\tconst manageDescOriginal = $manageDesc.text();\n\t\t// keep track of the original manage stock checkbox status, if we need to restore it later\n\t\tconst manageStockOriginal = $( '#_manage_stock' ).is( ':checked' );\n\n\t\t$( syncCheckboxID ).on( 'change', ( e ) => {\n\t\t\t// only handle stock fields if inventory sync is enabled.\n\t\t\tif ( ! wc_square_admin_products.is_inventory_sync_enabled ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst variableProduct = wc_square_admin_products.variable_product_types.includes( $( '#product-type' ).val() );\n\n\t\t\tlet useSquare;\n\n\t\t\tif ( $( e.target ).is( ':checked' ) && $( '#_square_item_variation_id' ).length > 0 ) {\n\t\t\t\tuseSquare = true;\n\n\t\t\t\t$manageDesc.html( '<a href=\"' + wc_square_admin_products.settings_url + '\">' + wc_square_admin_products.i18n.synced_with_square + '</a>' );\n\t\t\t\t$manageInput.prop( 'disabled', true ).prop( 'checked', ! variableProduct );\n\t\t\t\t$stockFields.hide();\n\t\t\t\t$stockStatus.hide();\n\t\t\t\t$stockInput.prop( 'readonly', true );\n\n\t\t\t\tif ( ! variableProduct ) {\n\t\t\t\t\t$stockFields.show();\n\t\t\t\t}\n\n\t\t\t\t// WooCommerce SoR - note: for variable products, the stock can be fetched for individual variations.\n\t\t\t\tif ( wc_square_admin_products.is_woocommerce_sor && ! variableProduct ) {\n\t\t\t\t\t// add inline note with a toggle to fetch stock from Square manually via AJAX (sanity check to avoid appending multiple times).\n\t\t\t\t\tif ( $( 'p._stock_field span.description' ).length === 0 ) {\n\t\t\t\t\t\t$stockInput.after(\n\t\t\t\t\t\t\t'<span class=\"description\" style=\"display:block;clear:both;\"><a href=\"#\" id=\"fetch-stock-with-square\">' + wc_square_admin_products.i18n.fetch_stock_with_square + '</a><div class=\"spinner\" style=\"float:none;\"></div></span>'\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\t$( '#fetch-stock-with-square' ).on( 'click', ( e ) => {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tconst $spinner = $( 'p._stock_field span.description .spinner' );\n\t\t\t\t\t\tconst data = {\n\t\t\t\t\t\t\taction: 'wc_square_fetch_product_stock_with_square',\n\t\t\t\t\t\t\tsecurity: wc_square_admin_products.fetch_product_stock_with_square_nonce,\n\t\t\t\t\t\t\tproduct_id: $( '#post_ID' ).val(),\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t$spinner.css( 'visibility', 'visible' );\n\n\t\t\t\t\t\t$.post( wc_square_admin_products.ajax_url, data, ( response ) => {\n\t\t\t\t\t\t\tif ( response && response.success ) {\n\t\t\t\t\t\t\t\tconst quantity = response.data;\n\n\t\t\t\t\t\t\t\t$stockInput.val( quantity );\n\t\t\t\t\t\t\t\t$stockFields.find( 'input[name=_original_stock]' ).val( quantity );\n\t\t\t\t\t\t\t\t$stockInput.prop( 'readonly', false );\n\t\t\t\t\t\t\t\t$( 'p._stock_field span.description' ).remove();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif ( response.data ) {\n\t\t\t\t\t\t\t\t\t$( '.inventory-fetch-error' ).remove();\n\t\t\t\t\t\t\t\t\t$spinner.after( '<span class=\"inventory-fetch-error\" style=\"display:inline-block;color:red;\">' + response.data + '</span>' );\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t$spinner.css( 'visibility', 'hidden' );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t} );\n\n\t\t\t\t// Square SoR.\n\t\t\t\t} else if ( wc_square_admin_products.is_square_sor ) {\n\t\t\t\t\t// add inline note explaining stock is managed by Square (sanity check to avoid appending multiple times)\n\t\t\t\t\tif ( $( 'p._stock_field span.description' ).length === 0 ) {\n\t\t\t\t\t\t$stockInput.after( '<span class=\"description\" style=\"display:block;clear:both;\">' + wc_square_admin_products.i18n.managed_by_square + '</span>' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tuseSquare = false;\n\n\t\t\t\t// remove any inline note to WooCommerce core stock fields that may have been added when Synced with Square is enabled.\n\t\t\t\t$( 'p._stock_field span.description' ).remove();\n\t\t\t\t$stockInput.prop( 'readonly', false );\n\t\t\t\t$manageDesc.html( manageDescOriginal );\n\t\t\t\t$manageInput.prop( 'disabled', false ).prop( 'checked', manageStockOriginal );\n\n\t\t\t\tif ( manageStockOriginal ) {\n\t\t\t\t\t$stockFields.show();\n\t\t\t\t\t$stockStatus.hide();\n\t\t\t\t} else {\n\t\t\t\t\t$stockStatus.show();\n\t\t\t\t\t$stockFields.hide();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// handle variations data separately (HTML differs from parent UI!).\n\t\t\t$( '.woocommerce_variation' ).each( ( index, e ) => {\n\t\t\t\t// fetch relevant variables for each variation.\n\t\t\t\tconst variationID = $( e ).find( 'h3 > a' ).attr( 'rel' );\n\t\t\t\tconst $variationManageInput = $( e ).find( '.variable_manage_stock' );\n\t\t\t\tconst $variationManageField = $variationManageInput.parent();\n\t\t\t\tconst $variationStockInput = $( e ).find( '.wc_input_stock' );\n\t\t\t\tconst $variationStockField = $variationStockInput.parent();\n\n\t\t\t\t// Square manages variations stock\n\t\t\t\tif ( useSquare ) {\n\t\t\t\t\t// disable stock management inputs\n\t\t\t\t\t$( '#wc_square_variation_manage_stock' ).prop( 'disabled', false );\n\t\t\t\t\t$variationStockInput.prop( 'readonly', true );\n\t\t\t\t\t$variationManageInput\n\t\t\t\t\t\t.prop( 'disabled', true )\n\t\t\t\t\t\t.prop( 'checked', true );\n\n\t\t\t\t\t// add a note that the variation stock is managed by square, but check if it wasn't added already to avoid duplicates.\n\t\t\t\t\tif ( 0 === $variationManageField.find( '.description' ).length ) {\n\t\t\t\t\t\t$variationManageInput.after( '<span class=\"description\">(' + wc_square_admin_products.i18n.managed_by_square + ')</span>' );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( wc_square_admin_products.is_woocommerce_sor ) {\n\t\t\t\t\t\tconst fetchVariationStockActionID = 'fetch-stock-with-square-' + variationID;\n\n\t\t\t\t\t\t// add inline note with a toggle to fetch stock from Square manually via AJAX (sanity check to avoid appending multiple times)\n\t\t\t\t\t\tif ( 0 === $variationStockField.find( 'span.description' ).length ) {\n\t\t\t\t\t\t\t$variationStockInput.after(\n\t\t\t\t\t\t\t\t'<span class=\"description\" style=\"display:block;clear:both;\"><a href=\"#\" id=\"' + fetchVariationStockActionID + '\">' + wc_square_admin_products.i18n.fetch_stock_with_square + '</a><div class=\"spinner\" style=\"float:none;\"></div></span>'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// listen for requests to update stock with Square for the individual variation.\n\t\t\t\t\t\t$( '#' + fetchVariationStockActionID ).on( 'click', ( e ) => {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tconst $spinner = $( e.target ).next( '.spinner' );\n\t\t\t\t\t\t\tconst data = {\n\t\t\t\t\t\t\t\taction: 'wc_square_fetch_product_stock_with_square',\n\t\t\t\t\t\t\t\tsecurity: wc_square_admin_products.fetch_product_stock_with_square_nonce,\n\t\t\t\t\t\t\t\tproduct_id: variationID,\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t$spinner.css( 'visibility', 'visible' );\n\n\t\t\t\t\t\t\t$.post( wc_square_admin_products.ajax_url, data, ( response ) => {\n\t\t\t\t\t\t\t\tif ( response && response.success ) {\n\t\t\t\t\t\t\t\t\tconst quantity = response.data;\n\n\t\t\t\t\t\t\t\t\t$variationStockInput.val( quantity );\n\t\t\t\t\t\t\t\t\t$variationStockField.parent().find( 'input[name^=\"variable_original_stock\"]' ).val( quantity );\n\t\t\t\t\t\t\t\t\t$variationStockInput.prop( 'readonly', false );\n\t\t\t\t\t\t\t\t\t$variationStockField.find( '.description' ).remove();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif ( response.data ) {\n\t\t\t\t\t\t\t\t\t\t$( '.inventory-fetch-error' ).remove();\n\t\t\t\t\t\t\t\t\t\t$spinner.after( '<span class=\"inventory-fetch-error\" style=\"display:inline-block;color:red;\">' + response.data + '</span>' );\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t$spinner.css( 'visibility', 'hidden' );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// restore WooCommerce stock when user chooses to disable Sync with Square checkbox.\n\t\t\t\t\t$variationStockInput.prop( 'readonly', false );\n\t\t\t\t\t$variationManageInput.prop( 'disabled', false );\n\t\t\t\t\t$variationManageInput.next( '.description' ).remove();\n\t\t\t\t\t$( e.target ).find( '#wc_square_variation_manage_stock' ).prop( 'disabled', true );\n\t\t\t\t}\n\t\t\t} );\n\t\t// initial page load handling.\n\t\t} ).trigger( 'change' );\n\n\t\t// trigger an update if the product type changes.\n\t\t$( '#product-type' ).on( 'change', () => {\n\t\t\ttriggerUpdate();\n\t\t} );\n\n\t\t// trigger an update for variable products when variations are loaded, added, or removed.\n\t\t$( '#woocommerce-product-data' ).on( 'woocommerce_variations_loaded woocommerce_variations_added woocommerce_variations_removed', () => {\n\t\t\ttriggerUpdate();\n\t\t} );\n\t}\n} );\n"],"file":"wc-square-admin-products.min.js"}